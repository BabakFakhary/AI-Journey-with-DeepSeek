<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <handlers>
      <add name="PythonHandler" path="*" verb="*" modules="FastCgiModule" scriptProcessor="C:\Python312\python.exe|C:\Users\Administrator\AppData\Roaming\Python\Python312\site-packages\wfastcgi.py" resourceType="Unspecified" requireAccess="Script" />
    </handlers>
    
    <security>
      <requestFiltering>
        <hiddenSegments>
          <add segment="venv" />
          <add segment="__pycache__" />
          <add segment="model_cache" />
          <add segment="logs" />
        </hiddenSegments>
      </requestFiltering>
    </security>
    
    <!-- افزایش timeout برای مدل‌های بزرگ -->
    <fastCgi>
      <application fullPath="C:\Python312\python.exe">
        <environmentVariables>
          <environmentVariable name="PYTHONPATH" value="." />
          <environmentVariable name="WSGI_HANDLER" value="entry.application" />
        </environmentVariables>
      </application>
    </fastCgi>
    
  </system.webServer>
  
  <appSettings>
    <add key="PYTHONPATH" value="." />
    <add key="WSGI_HANDLER" value="entry.application" />
    <!-- غیرفعال کردن pycache برای Python 3.12 -->
    <add key="PYTHONDONTWRITEBYTECODE" value="1" />
  </appSettings>
</configuration>